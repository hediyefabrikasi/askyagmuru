<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Kalp YaÄŸmuru ğŸ’–</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial, sans-serif}
body{
  background:linear-gradient(180deg,#ff7eb3,#ff758c);
  height:100vh;
  overflow:hidden;
  touch-action:none;
}
#game{
  position:relative;
  width:100%;
  max-width:420px;
  height:100vh;
  margin:0 auto;
  overflow:hidden;
  background:rgba(255,255,255,0.15);
  border-radius:0;
}
#hud{
  position:absolute;
  top:8px;
  left:0;
  width:100%;
  display:flex;
  justify-content:space-between;
  padding:0 12px;
  font-size:14px;
  color:white;
  z-index:5;
}
#player{
  position:absolute;
  bottom:12px;
  width:64px;
  height:64px;
  background:url("images/player.png") center/contain no-repeat;
  left:50%;
  transform:translateX(-50%);
  pointer-events:none;
}
.item{
  position:absolute;
  width:52px;
  height:52px;
  border-radius:12px;
  background-size:cover;
  background-position:center;
}
.bomb{
  background:url("images/bomb.png") center/contain no-repeat;
}
#startScreen,#gameOverScreen{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.6);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:white;
  text-align:center;
  z-index:10;
}
button{
  background:#fff;
  border:none;
  padding:12px 20px;
  border-radius:999px;
  font-weight:bold;
  margin-top:12px;
  cursor:pointer;
}
</style>
</head>
<body>

<div id="game">
  <div id="hud">
    <div>ğŸ’– Skor: <span id="score">0</span></div>
    <div>ğŸ”¥ Combo: <span id="combo">0</span></div>
    <div>ğŸ† En Ä°yi: <span id="best">0</span></div>
  </div>

  <div id="player"></div>

  <div id="startScreen">
    <h1>ğŸ’˜ Kalp YaÄŸmuru</h1>
    <p>Sevgilinin fotoÄŸraflarÄ±nÄ± yakala, bombalardan kaÃ§!</p>
    <button id="startBtn">Oyuna BaÅŸla</button>
  </div>

  <div id="gameOverScreen" style="display:none">
    <h2>ğŸ’” Oyun Bitti</h2>
    <p>Skorun: <span id="finalScore">0</span></p>
    <button id="restartBtn">Tekrar Oyna</button>
  </div>
</div>

<audio id="catchSound" src="audios/catch.mp3"></audio>
<audio id="bombSound" src="audios/bomb.mp3"></audio>
<audio id="bgSound" src="audios/bg.mp3" loop></audio>

<script>
const game = document.getElementById("game");
const player = document.getElementById("player");
const scoreEl = document.getElementById("score");
const comboEl = document.getElementById("combo");
const bestEl = document.getElementById("best");
const startScreen = document.getElementById("startScreen");
const gameOverScreen = document.getElementById("gameOverScreen");
const finalScoreEl = document.getElementById("finalScore");

const catchSound = document.getElementById("catchSound");
const bombSound = document.getElementById("bombSound");
const bgSound = document.getElementById("bgSound");

let gameWidth, gameHeight;
let playerX;
let score = 0;
let combo = 0;
let speed = 2.2;
let running = false;
let spawnInterval;
let moveInterval;

const images = [
  "images/love1.jpg",
  "images/love2.jpg",
  "images/love3.jpg"
];

const bestScore = localStorage.getItem("kalpBest") || 0;
bestEl.textContent = bestScore;

function resize(){
  gameWidth = game.clientWidth;
  gameHeight = game.clientHeight;
}
window.addEventListener("resize", resize);
resize();

function startGame(){
  score = 0;
  combo = 0;
  speed = 2.2;
  running = true;
  scoreEl.textContent = 0;
  comboEl.textContent = 0;
  startScreen.style.display = "none";
  gameOverScreen.style.display = "none";
  bgSound.currentTime = 0;
  bgSound.play().catch(()=>{});

  playerX = gameWidth / 2 - player.offsetWidth / 2;
  player.style.left = playerX + "px";

  spawnInterval = setInterval(spawnItem, 700);
  moveInterval = setInterval(moveItems, 16);
}

function endGame(){
  running = false;
  clearInterval(spawnInterval);
  clearInterval(moveInterval);
  document.querySelectorAll(".item").forEach(e=>e.remove());
  bgSound.pause();
  finalScoreEl.textContent = score;

  if(score > bestScore){
    localStorage.setItem("kalpBest", score);
    bestEl.textContent = score;
  }

  gameOverScreen.style.display = "flex";
}

function spawnItem(){
  if(!running) return;
  const el = document.createElement("div");
  el.classList.add("item");

  const isBomb = Math.random() < 0.22;
  if(isBomb){
    el.classList.add("bomb");
  } else {
    const img = images[Math.floor(Math.random()*images.length)];
    el.style.backgroundImage = `url(${img})`;
  }

  el.dataset.type = isBomb ? "bomb" : "love";
  el.style.left = Math.random() * (gameWidth - 52) + "px";
  el.style.top = "-60px";
  el.dataset.y = -60;
  game.appendChild(el);
}

function moveItems(){
  if(!running) return;
  document.querySelectorAll(".item").forEach(el=>{
    let y = parseFloat(el.dataset.y);
    y += speed;
    el.dataset.y = y;
    el.style.top = y + "px";

    if(checkCollision(el)){
      if(el.dataset.type === "bomb"){
        bombSound.currentTime = 0;
        bombSound.play().catch(()=>{});
        endGame();
      } else {
        catchSound.currentTime = 0;
        catchSound.play().catch(()=>{});
        score += 10 + combo*2;
        combo++;
        speed += 0.05;
        scoreEl.textContent = score;
        comboEl.textContent = combo;
        el.remove();
      }
    }

    if(y > gameHeight + 60){
      combo = 0;
      comboEl.textContent = combo;
      el.remove();
    }
  });
}

function checkCollision(el){
  const p = player.getBoundingClientRect();
  const i = el.getBoundingClientRect();
  return !(i.right < p.left || i.left > p.right || i.bottom < p.top || i.top > p.bottom);
}

game.addEventListener("pointermove", e=>{
  if(!running) return;
  const rect = game.getBoundingClientRect();
  let x = e.clientX - rect.left - player.offsetWidth/2;
  x = Math.max(0, Math.min(gameWidth - player.offsetWidth, x));
  playerX = x;
  player.style.left = x + "px";
});

document.getElementById("startBtn").onclick = startGame;
document.getElementById("restartBtn").onclick = startGame;
</script>
</body>
</html>
